swagger: '2.0'
info:
  title: Kasim API
  description: Kasim API
  contact:
    email: admin@executableknowledge.org
  license:
    name: LGPL
    url: 'http://www.gnu.org/licenses/lgpl-3.0.en.html'
  version: 4.0.0
host: api.executableknowledge.org
schemes:
  - https
basePath: /kappa/v2
consumes:
  - application/json
produces:
  - application/json
tags:
  - name: model
  - name: simulation
  - name: analyses
  - name: causality
  - name: ODE
paths:
  /projects:
    get:
      tags:
        - model
      summary: List of projets
      responses:
        '200':
          description: list of project id
    post:
      tags:
        - model
      parameters:
        - in: body
          name: project
          schema:
            type: object
            required:
              - project_id
            properties:
              project_id:
                type: string
          required: true
      summary: Create project
      responses:
        '200':
          description: OK
        '500':
          description: Project already exists
          schema:
            $ref: '#/definitions/Error'
  '/projects/{project_id}':
    parameters:
      - in: path
        name: project_id
        type: string
        required: true
    get:
      tags:
        - model
      summary: Get project info
      responses:
        '200':
          description: Information
        '404':
          description: Project does not exist
          schema:
            $ref: '#/definitions/Error'
    delete:
      tags:
        - model
      summary: Delete project
      responses:
        '200':
          description: OK
        '404':
          description: Project does not exist
          schema:
            $ref: '#/definitions/Error'
  '/projects/{project_id}/parse':
    parameters:
      - in: path
        name: project_id
        type: string
        required: true
    post:
      tags:
        - model
      parameters:
        - in: body
          name: overwritten_vars
          schema:
            type: array
            items:
              type: number
          required: true
      summary: Compile the model
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
  '/projects/{project_id}/files':
    parameters:
      - in: path
        name: project_id
        type: string
        required: true
    post:
      tags:
        - model
      parameters:
        - in: body
          name: file
          schema:
            $ref: '#/definitions/File'
          required: true
      summary: Add a file to the project
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
    get:
      tags:
        - model
      summary: Get file catalog
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
  '/projects/{project_id}/files/{file_id}':
    parameters:
      - in: path
        name: project_id
        type: string
        required: true
      - in: path
        name: file_id
        type: string
        required: true
    put:
      tags:
        - model
      parameters:
        - in: body
          name: file
          schema:
            $ref: '#/definitions/File_modification'
      summary: Modify a file
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
    get:
      tags:
        - model
      summary: Get a file
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
    delete:
      tags:
        - model
      summary: Remove a file from the project
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
  '/projects/{project_id}/simulation':
    parameters:
      - in: path
        name: project_id
        type: string
        required: true
    post:
      tags:
        - simulation
      summary: Launch a simulation
      parameters:
        - in: body
          name: parameters
          schema:
            $ref: '#/definitions/Simulation_parameter'
          required: true
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
    get:
      tags:
        - simulation
      summary: Get simulation status
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
    delete:
      tags:
        - simulation
      summary: Delete the current simulation
      description: All outputs are lost
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
  '/projects/{project_id}/simulation/pause':
    put:
      tags:
        - simulation
      summary: Pause the simulation
      parameters:
        - in: path
          name: project_id
          type: string
          required: true
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
  '/projects/{project_id}/simulation/continue':
    put:
      tags:
        - simulation
      summary: Restart the simulation
      description: with new parameters
      parameters:
        - in: path
          name: project_id
          type: string
          required: true
        - in: body
          name: parameters
          schema:
            $ref: '#/definitions/Simulation_parameter'
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
  '/projects/{project_id}/simulation/perturbation':
    put:
      tags:
        - simulation
      summary: Execute a perturbation
      description: the siulation must be paused
      parameters:
        - in: path
          name: project_id
          type: string
          required: true
        - in: body
          name: perturbation
          schema:
            type: object
            required:
              - perturbation_code
            properties:
              perturbation_code:
                type: string
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
  '/projects/{project_id}/simulation/parameter':
    get:
      tags:
        - simulation
      summary: Parameters used to launch the simulation
      parameters:
        - in: path
          name: project_id
          type: string
          required: true
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
  '/projects/{project_id}/simulation/logmessages':
    get:
      tags:
        - simulation
      summary: Get simulation log
      parameters:
        - in: path
          name: project_id
          type: string
          required: true
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
  '/projects/{project_id}/simulation/efficiency':
    get:
      tags:
        - simulation
      summary: Get simulation efficiency
      description: Number of null events and their reason
      parameters:
        - in: path
          name: project_id
          type: string
          required: true
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
  '/projects/{project_id}/simulation/plot':
    get:
      tags:
        - simulation
      summary: Get observable values
      parameters:
        - in: path
          name: project_id
          type: string
          required: true
        - in: query
          name: plot_limit_points
          type: integer
        - in: query
          name: plot_limit_offset
          type: integer
      responses:
        '200':
          description: OK
        '404':
          description: project not found
          schema:
            $ref: '#/definitions/Error'
        default:
          $ref: '#/responses/Default'
  '/projects/{project_id}/simulation/trace':
    get:
      tags:
        - simulation
      summary: Get the trace of the simulation
      parameters:
        - in: path
          name: project_id
          type: string
          required: true
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
  '/projects/{project_id}/simulation/filelines':
    get:
      tags:
        - simulation
      summary: List files generated by $PRINT
      parameters:
        - in: path
          name: project_id
          type: string
          required: true
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
  '/projects/{project_id}/simulation/filelines/{fileline_id}':
    get:
      tags:
        - simulation
      summary: Get a file generated by $PRINT
      parameters:
        - in: path
          name: project_id
          type: string
          required: true
        - in: path
          name: fileline_id
          type: string
          required: true
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
  '/projects/{project_id}/simulation/fluxmaps':
    get:
      tags:
        - simulation
      summary: List the dynamic influence map
      parameters:
        - in: path
          name: project_id
          type: string
          required: true
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
  '/projects/{project_id}/simulation/fluxmaps/{DIN_id}':
    get:
      tags:
        - simulation
      summary: Get a DIN
      parameters:
        - in: path
          name: project_id
          type: string
          required: true
        - in: path
          name: DIN_id
          type: string
          required: true
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
  '/projects/{project_id}/simulation/snapshots':
    get:
      tags:
        - simulation
      summary: List snapshots
      parameters:
        - in: path
          name: project_id
          type: string
          required: true
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
  '/projects/{project_id}/simulation/snapshots/{snap_id}':
    get:
      tags:
        - simulation
      summary: Get a snapshot
      description: >-
        This does not fire the computation of a snapshot. It sends an already
        available one.
      parameters:
        - in: path
          name: project_id
          type: string
          required: true
        - in: path
          name: snap_id
          type: string
          required: true
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
  '/projects/{project_id}/analyses':
    put:
      tags:
        - analyses
      summary: Initialize the static analyser
      parameters:
        - in: path
          name: project_id
          type: string
          required: true
        - in: body
          name: model
          schema:
            type: object
            description: JSON of the model AST
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
  '/projects/{project_id}/analyses/contact_map':
    get:
      tags:
        - analyses
      summary: Get contact map JSON
      parameters:
        - in: path
          name: project_id
          type: string
          required: true
        - in: query
          name: accuracy
          type: string
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
  '/projects/{project_id}/analyses/influence_map':
    get:
      tags:
        - analyses
      summary: Get influence map
      description: only the neighbours of a node when origin is given
      parameters:
        - in: path
          name: project_id
          type: string
          required: true
        - in: query
          name: accuracy
          type: string
        - in: query
          name: fwd
          type: integer
        - in: query
          name: bwd
          type: integer
        - in: query
          name: total
          type: integer
        - in: query
          name: origin
          type: string
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
  '/projects/{project_id}/analyses/dead_rules':
    get:
      tags:
        - analyses
      summary: Return dead rules
      parameters:
        - in: path
          name: project_id
          type: string
          required: true
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
  '/projects/{project_id}/analyses/constraints':
    get:
      tags:
        - analyses
      summary: Get model invariants
      parameters:
        - in: path
          name: project_id
          type: string
          required: true
      responses:
        '200':
          description: OK
        default:
          $ref: '#/responses/Default'
responses:
  Default:
    description: Something went wrong
    schema:
      $ref: '#/definitions/Error'
definitions:
  File_version:
    type: object
    properties:
      client_id:
        type: string
      local_version_file_version:
        type: integer
  File_metadata:
    type: object
    required:
      - compile
      - id
      - position
    properties:
      compile:
        type: boolean
      hash:
        type: string
      id:
        type: string
      position:
        type: integer
      version:
        $ref: '#/definitions/File_version'
  File:
    type: object
    required:
      - metadata
      - content
    properties:
      metadata:
        $ref: '#/definitions/File_metadata'
      content:
        type: string
  File_patch:
    type: object
    required:
      - file_patch_content
    properties:
      file_patch_start:
        type: integer
      file_patch_stop:
        type: integer
      file_patch_content:
        type: string
  File_modification:
    type: object
    required:
      - file_modification_version
    properties:
      file_modification_version:
        $ref: '#/definitions/File_version'
      compile:
        type: boolean
      id:
        type: string
      position:
        type: integer
      content:
        $ref: '#/definitions/File_patch'
      hash:
        type: string
  Simulation_parameter:
    type: object
    required:
      - plot_period
      - pause_condition
      - simulation_id
      - store_trace
    properties:
      plot_period:
        type: number
      pause_condition:
        type: string
      simulation_id:
        type: string
      seed:
        type: integer
      store_trace:
        type: boolean
  Error:
    type: object
    properties:
      message_severity:
        type: string
      message_text:
        type: string
      message_range:
        type: object
